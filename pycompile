#!/usr/bin/env bash

compile_machine=centos67
compile_path=/root/pycompile/
compile_venv=/root/venv/bin/activate
compile_filename=t.py
output_filepath=/root/pycompile/dist/t

if [ $# -lt 1 ]; then
    echo "file to compile nor provided"
    exit -1
fi
filename=$1

NAME=`echo $filename | cut -d'.' -f1`
EXTENSION=`echo $filename | cut -d'.' -f2`

scp $filename $compile_machine:$compile_path/$compile_filename
ssh $compile_machine "source $compile_venv && cd $compile_path && make"

scp $compile_machine:$output_filepath ./$NAME
