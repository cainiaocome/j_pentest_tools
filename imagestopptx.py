#!/usr/bin/env python3
# encoding: utf8

import os
import sys
from pptx import Presentation
from pptx.util import Inches

if len( sys.argv ) < 2:
    print( 'usage: imagestopptx.py images_dir_name' )
    sys.exit(0)

dirname = sys.argv[1]

presentation = Presentation()

for filename in sorted( os.listdir( dirname ) ):

    filepath = os.path.join( dirname, filename )
    
    blank_slide_layout = presentation.slide_layouts[6]

    slide = presentation.slides.add_slide( blank_slide_layout )

    left = top = Inches( 0 )
    height = Inches( 7.3 )

    pic = slide.shapes.add_picture( filepath, left, top, height=height )

presentation.save( 'test.pptx' )
print( 'output pptx write to test.pptx' )
